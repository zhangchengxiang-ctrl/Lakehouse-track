# StarRocks 存算分离 FE 配置（复用 MinIO lakehouse bucket）
# 与 Paimon/Flink 共用同一 MinIO，数据存于 s3://lakehouse/starrocks/
# 架构：FE (元数据) + CN (无状态计算) + S3 (持久化存储) + 本地 DataCache (热数据)

run_mode = shared_data

# ---- S3 存储后端 (MinIO) ----
cloud_native_storage_type = S3
aws_s3_endpoint = minio:9000
aws_s3_path = lakehouse
aws_s3_access_key = minioadmin
aws_s3_secret_key = minioadmin
aws_s3_use_instance_profile = false
aws_s3_use_aws_sdk_default_behavior = false

# 从 FE 配置自动创建内置 Storage Volume（无需手动 CREATE STORAGE VOLUME）
enable_load_volume_from_conf = true

# ---- 存算分离缓存策略 ----
query_port = 9030

# 开启 Data Cache 异步预热：CN 启动/扩容后主动拉取热数据到本地缓存
# 避免冷启动时所有查询都走 S3，显著降低首查延迟
enable_shared_data_mode_warmup = true

# ---- 性能与运维 ----
# 物化视图查询改写
enable_materialized_view_rewrite = true
# 自动元数据清理（3.5+）
enable_shared_data_mode_metadata_cleanup = true
# 统计信息自动收集（优化查询计划）
enable_stats_auto_collect = true
# 元数据缓存内存限制（防止 FE OOM）
metadata_cache_memory_limit_percent = 20
# 慢查询阈值
slow_query_log_threshold_ms = 1000
